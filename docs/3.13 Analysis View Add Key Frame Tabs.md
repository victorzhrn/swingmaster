# Analysis View UI Implementation

## Component Code

### 1. ViewControlsPanel

```swift
struct ViewControlsPanel: View {
    @Binding var selectedView: String
    @State private var showDropdown = false
    
    let viewOptions = ["Racket Path", "Wrist Path", "Skeleton", "Off"]
    
    var body: some View {
        Button(action: { showDropdown.toggle() }) {
            HStack(spacing: 4) {
                Text("View:")
                    .foregroundColor(.white.opacity(0.6))
                Text(selectedView)
                    .fontWeight(.semibold)
                Image(systemName: "chevron.down")
                    .font(.caption)
                    .opacity(0.6)
            }
            .font(.subheadline)
            .foregroundColor(.white.opacity(0.95))
            .padding(.horizontal, 16)
            .frame(height: 44)
        }
        .background(.thinMaterial)
        .overlay(
            RoundedRectangle(cornerRadius: 22)
                .stroke(Color.white.opacity(0.15), lineWidth: 1)
        )
        .clipShape(RoundedRectangle(cornerRadius: 22))
        .overlay(dropdownMenu, alignment: .top)
    }
    
    @ViewBuilder
    var dropdownMenu: some View {
        if showDropdown {
            VStack(alignment: .leading, spacing: 0) {
                ForEach(viewOptions, id: \.self) { option in
                    Button(action: { 
                        selectedView = option
                        showDropdown = false
                    }) {
                        HStack {
                            Image(systemName: "checkmark")
                                .opacity(selectedView == option ? 1 : 0)
                                .frame(width: 20)
                            Text(option)
                        }
                        .frame(maxWidth: .infinity, alignment: .leading)
                        .padding(.vertical, 12)
                        .padding(.horizontal, 16)
                    }
                    if option != viewOptions.last {
                        Divider()
                    }
                }
            }
            .font(.subheadline)
            .foregroundColor(.white)
            .background(.regularMaterial)
            .cornerRadius(12)
            .offset(y: -160)
        }
    }
}
```

### 2. CompareToggle

```swift
struct CompareToggle: View {
    @Binding var isComparing: Bool
    
    var body: some View {
        Button(action: { 
            isComparing.toggle()
            UIImpactFeedbackGenerator(style: .medium).impactOccurred()
        }) {
            HStack(spacing: 6) {
                Image(systemName: "person.2.fill")
                    .font(.caption)
                Text("Compare")
                    .font(.subheadline.weight(.medium))
            }
            .foregroundColor(isComparing ? .white : .white.opacity(0.8))
            .padding(.horizontal, 16)
            .frame(height: 44)
        }
        .background(isComparing ? TennisColors.tennisGreen : Color.clear)
        .background(.thinMaterial)
        .overlay(
            RoundedRectangle(cornerRadius: 22)
                .stroke(Color.white.opacity(0.15), lineWidth: 1)
        )
        .clipShape(RoundedRectangle(cornerRadius: 22))
        .animation(.spring(response: 0.3, dampingFraction: 0.8), value: isComparing)
    }
}
```

### 3. KeyframeTabs

```swift
struct KeyframeTabs: View {
    let keyframeLabels = ["Ready", "Back", "Contact", "Follow", "End"]
    let keyframeTimes = ["0.0s", "0.6s", "1.2s", "1.8s", "2.3s"]
    @State private var selectedIndex = 0
    
    var body: some View {
        HStack(spacing: 2) {
            ForEach(0..<keyframeLabels.count, id: \.self) { index in
                Button(action: {
                    selectedIndex = index
                    UIImpactFeedbackGenerator(style: .light).impactOccurred()
                }) {
                    VStack(spacing: 2) {
                        Text(keyframeLabels[index])
                            .font(.subheadline)
                        Text(keyframeTimes[index])
                            .font(.caption2)
                            .opacity(0.7)
                    }
                    .foregroundColor(selectedIndex == index ? TennisColors.tennisGreen : .white.opacity(0.7))
                    .frame(maxWidth: .infinity)
                    .frame(height: 40)
                    .background(
                        RoundedRectangle(cornerRadius: 8)
                            .fill(selectedIndex == index ? TennisColors.tennisGreen.opacity(0.2) : Color.clear)
                    )
                }
                .buttonStyle(PlainButtonStyle())
            }
        }
        .frame(height: 44)
    }
}
```

### 4. NavigationPanel

```swift
struct NavigationPanel: View {
    var body: some View {
        VStack(spacing: 8) {
            // Keyframe tabs
            KeyframeTabs()
            
            // Divider
            Rectangle()
                .fill(Color.white.opacity(0.1))
                .frame(height: 0.5)
            
            // Existing timeline (placeholder for your existing TimelineStripEnhanced)
            Text("Timeline goes here")
                .foregroundColor(.white.opacity(0.3))
                .frame(height: 48)
        }
        .padding(.horizontal, 16)
        .padding(.vertical, 12)
        .background(.thinMaterial)
        .overlay(
            RoundedRectangle(cornerRadius: 16)
                .stroke(Color.white.opacity(0.15), lineWidth: 1)
        )
        .clipShape(RoundedRectangle(cornerRadius: 16))
    }
}
```

### 5. Updated AnalysisView Bottom Section

```swift
// Replace bottom control panel in AnalysisView with:

VStack {
    Spacer()
    
    // Floating controls layer
    HStack(alignment: .bottom) {
        ViewControlsPanel(selectedView: $currentViewMode)
            .frame(width: 180)
        
        Spacer()
        
        CompareToggle(isComparing: $isComparing)
            .frame(width: 110)
    }
    .padding(.horizontal, 16)
    .padding(.bottom, 8)
    
    // Navigation panel (full width)
    NavigationPanel()
        .padding(.horizontal, 16)
        .padding(.bottom, geometry.safeAreaInsets.bottom + 8)
}