# Minimal Shot Metrics Display - Implementation Plan

## Overview
Remove AI analysis and display raw metrics from `SegmentMetrics`. Zero fancy features. Just show the numbers.

## Phase 1: Remove AI Code

### 1.1 Clean Shot Model (`Models/Shot.swift`)

**REMOVE these fields:**
```swift
// DELETE (lines 60-64):
var strengths: [String]
var improvements: [String]
var hasAIAnalysis: Bool = false

// DELETE from CodingKeys (line 72):
case strengths, improvements, hasAIAnalysis

// DELETE from init parameters (line 85):
strengths: [String] = [], improvements: [String] = [], hasAIAnalysis: Bool = false

// DELETE from init assignment (lines 94-96):
self.strengths = strengths
self.improvements = improvements
self.hasAIAnalysis = hasAIAnalysis
```

**KEEP:**
```swift
var segmentMetrics: SegmentMetrics? = nil  // This has our metrics
```

### 1.2 Remove from AnalysisView (`Views/AnalysisView.swift`)

**DELETE:**
```swift
// Line 18:
@StateObject private var aiService = AIAnalysisService()

// Lines 282-365 - entire function:
@ViewBuilder
private func aiAnalysisSection(for shot: Shot) -> some View { ... }

// Lines 367-383 - entire function:  
private func generateAnalysis(for shot: Shot) async { ... }
```

### 1.3 **DELETE ENTIRE FILE**: `Managers/AIAnalysisService.swift`
This 71-line file can be completely removed as it only handles on-demand AI analysis.

### 1.4 Clean AnalysisResult Model (`Models/AnalysisResult.swift`)

**REMOVE these fields:**
```swift
// DELETE (lines 16-17):
public var strengths: [String]
public var improvements: [String]

// DELETE from init parameters (lines 28-29):
strengths: [String],
improvements: [String],

// DELETE from init assignment (lines 37-38):
self.strengths = strengths
self.improvements = improvements
```

**KEEP:**
```swift
public var segmentMetrics: SegmentMetrics?  // This has our metrics
```

### 1.5 Simplify GeminiValidator (`Core/GeminiValidator.swift`)

The current `GeminiValidator.swift` has 563 lines but can be dramatically simplified:

**ENTIRE FUNCTIONS TO DELETE:**
- `analyzeSwing()` method (lines 83-93) - used only for AI analysis
- `makeAnalysisPrompt()` method (lines 287-343) - generates AI prompts
- `parseAnalysisResponse()` method (lines 390-441) - parses AI responses
- `AnalysisResponseV2` struct (lines 376-380) - AI response parsing

**KEEP ONLY:**
- `validateSwing()` method - still needed for swing detection
- `ValidationResponse` struct - still needed for validation
- Image rendering and networking code - still needed

This reduces `GeminiValidator.swift` from 563 lines to ~400 lines.

## Phase 2: Add Simple Metrics Display

### 2.1 Add Minimal Metrics Display to AnalysisView

**REPLACE** in `enhancedInsightCard` (around line 266):

```swift
// CHANGE FROM:
if let selected = selected {
    aiAnalysisSection(for: selected)
}

// CHANGE TO:
if let selected = selected, let metrics = selected.segmentMetrics {
    simpleMetricsDisplay(metrics)
}
```

**ADD** this simple function to AnalysisView:

```swift
// MARK: - Simple Metrics Display

@ViewBuilder
private func simpleMetricsDisplay(_ metrics: SegmentMetrics) -> some View {
    VStack(alignment: .leading, spacing: 10) {
        
        // Peak Speed
        HStack {
            Image(systemName: "bolt.fill")
                .foregroundColor(.orange)
                .frame(width: 20)
            Text("Peak Speed")
                .foregroundColor(.secondary)
            Spacer()
            Text("\(Int(metrics.peakAngularVelocity)) rad/s")
                .font(.system(.body, design: .monospaced))
                .fontWeight(.medium)
        }
        
        // Shoulder Rotation  
        HStack {
            Image(systemName: "arrow.triangle.2.circlepath")
                .foregroundColor(.blue)
                .frame(width: 20)
            Text("Shoulder Turn")
                .foregroundColor(.secondary)
            Spacer()
            Text("\(Int(metrics.backswingAngle))Â°")
                .font(.system(.body, design: .monospaced))
                .fontWeight(.medium)
        }
        
        // Contact Point Height
        HStack {
            Image(systemName: "target")
                .foregroundColor(.green)
                .frame(width: 20)
            Text("Contact Height")
                .foregroundColor(.secondary)
            Spacer()
            Text("\(Int(metrics.contactPoint.y * 100))%")
                .font(.system(.body, design: .monospaced))
                .fontWeight(.medium)
        }
        
        // Follow Through
        HStack {
            Image(systemName: "arrow.up.right")
                .foregroundColor(.purple)
                .frame(width: 20)
            Text("Follow Through")
                .foregroundColor(.secondary)
            Spacer()
            Text("\(Int(metrics.followThroughHeight * 100))%")
                .font(.system(.body, design: .monospaced))
                .fontWeight(.medium)
        }
        
        // Tracking Quality
        HStack {
            Image(systemName: "checkmark.circle")
                .foregroundColor(metrics.averageConfidence > 0.7 ? .green : .orange)
                .frame(width: 20)
            Text("Tracking Quality")
                .foregroundColor(.secondary)
            Spacer()
            Text("\(Int(metrics.averageConfidence * 100))%")
                .font(.system(.body, design: .monospaced))
                .fontWeight(.medium)
        }
    }
}
```

### 1.6 Clean VideoProcessor (`Core/VideoProcessor.swift`)

**REMOVE AI-related mapping:**
```swift
// DELETE from mapToDisplayData method:
strengths: result.strengths,
improvements: result.improvements
```

### 1.7 Clean ProcessingManager (`Managers/ProcessingManager.swift`)

**REMOVE AI analysis status:**
- Remove `analyzingSwings` from `ProcessingStatus` enum
- Simplify status mapping to skip AI analysis steps

### 1.8 Clean AnalysisStore (`Managers/AnalysisStore.swift`)

**REMOVE AI-related methods:**
```swift
// DELETE entire method:
static func updateShotAnalysis(videoFileName: String, shotID: UUID, 
                              strengths: [String], improvements: [String], score: Float)
```

## Phase 3: Ensure Metrics Are Populated

### 3.1 Verify Shot Creation Has Metrics

In `VideoProcessor.swift`, ensure `Shot` objects include metrics:

```swift
let shot = Shot(
    // ... other fields ...
    segmentMetrics: result.segmentMetrics  // MAKE SURE THIS IS INCLUDED
)
```

### 3.2 Update Sample Data (for previews)

In `Models/Shot.swift`, update sample shots:

```swift
extension Array where Element == Shot {
    static func sampleShots(duration: Double) -> [Shot] {
        // ... existing code ...
        
        // Add sample metrics
        let sampleMetrics = SegmentMetrics(
            peakAngularVelocity: 14.5,
            peakLinearVelocity: 1.2,
            contactPoint: CGPoint(x: 0.6, y: 0.45),
            backswingAngle: 95,
            followThroughHeight: 0.72,
            averageConfidence: 0.83
        )
        
        // Add to each shot
        return shots.map { shot in
            var updated = shot
            updated.segmentMetrics = sampleMetrics
            return updated
        }
    }
}
```

## That's It! 

### Summary of Removals:
- **Delete entire file**: `Managers/AIAnalysisService.swift` (71 lines)
- **Shot.swift**: Remove 3 AI fields + CodingKeys + init parameters (~15 lines)
- **AnalysisView.swift**: Remove AI service + 2 large functions (~100 lines)
- **AnalysisResult.swift**: Remove 2 AI fields + init parameters (~10 lines)
- **GeminiValidator.swift**: Remove 4 AI analysis methods (~160 lines)
- **VideoProcessor.swift**: Remove AI mapping (~5 lines)
- **ProcessingManager.swift**: Remove AI status (~10 lines)
- **AnalysisStore.swift**: Remove AI update method (~15 lines)

**Total Removed**: ~386 lines of AI code

### Added:
- **AnalysisView.swift**: Simple metrics display function (~70 lines)
- **Shot.swift**: Sample metrics data (~15 lines)

**Total Added**: ~85 lines of simple metrics display

### **Net Change**: -301 lines (simplified by ~78%!)

### What Users See:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš¡ Peak Speed     14 rad/s â”‚
â”‚ ğŸ”„ Shoulder Turn  95Â°      â”‚
â”‚ ğŸ¯ Contact Height 45%      â”‚
â”‚ â†—ï¸ Follow Through  72%      â”‚
â”‚ âœ“ Tracking Quality 83%    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

No AI analysis. No on-demand features. No complex state management. Just the raw numbers from `SegmentMetrics`.

**Ship it!** ğŸš€